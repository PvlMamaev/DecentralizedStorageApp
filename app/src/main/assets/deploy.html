<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TON Connect</title>
    <style>
        body {
          font-family: sans-serif;
          padding: 1rem;
          text-align: center;
        }
        #connect-button {
          margin-top: 2rem;
        }
    </style>
    <script type="module">
        import { TonConnectUI } from "https://unpkg.com/@tonconnect/ui@0.2.6/dist/tonconnect-ui.min.js";
        import { toNano } from "https://unpkg.com/@ton/core@0.0.5/dist/index.all.mjs";

        console.log("üî• HTML –∑–∞–≥—Ä—É–∂–µ–Ω");

        const tonConnectUI = new TonConnectUI({
          manifestUrl: "https://pvlmamaev.github.io/DecentralizedStorageApp/app/src/main/assets/tonconnect-manifest.json"
        });

        tonConnectUI.uiOptions = {
          buttonRootId: "connect-button"
        };

        tonConnectUI.renderWalletConnection();

        // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ Android —á–µ—Ä–µ–∑ WebView
        window.sendCid = async function (cidBoc) {
          console.log("üì¶ –ü–æ–ª—É—á–µ–Ω CID –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏:", cidBoc);

          try {
            await tonConnectUI.sendTransaction({
              validUntil: Math.floor(Date.now() / 1000) + 600,
              messages: [
                {
                  address: "EQANpQ6yztUW2Cl9EbSFIKgzcdacgv6MOFfR4qpZgs5YOuMN",
                  amount: toNano("0.05").toString(),
                  payload: cidBoc
                }
              ]
            });

            alert("‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!");
          } catch (error) {
            console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ:", error);
            alert("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ: " + error);
          }
        };
    </script>
</head>
<body>
<h1>TON Connect</h1>
<div id="connect-button"></div>
</body>
</html>
